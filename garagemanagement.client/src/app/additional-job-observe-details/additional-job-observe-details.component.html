<section class="supervisor-section">
  <div class="container p-4">
    <form [formGroup]="jobForm" (ngSubmit)="submit()">
      <table class="table table-bordered text-center align-middle">
        <thead class="table-primary">
          <tr>
            <th>Sl. No.</th>
            <th>Technician Voice</th>
            <th>Supervisor Instructions</th>
            <th>Action Taken</th>
            <th>Start Time</th>
            <th>End Time</th>
            <th>Action</th>
          </tr>
        </thead>

        <tbody formArrayName="rows">
          <tr *ngFor="let row of rows.controls; let i = index" [formGroupName]="i">
            <td>{{ i + 1 }}</td>

            <td>
              <input type="text" class="form-control" formControlName="technicianVoice" placeholder="Technician Voice" maxlength="50" />
              <div class="error" *ngIf="row.get('technicianVoice')?.invalid && row.get('technicianVoice')?.touched">
                Alphabets only (max 50).
              </div>
            </td>

            <td>
              <input type="text" class="form-control" formControlName="supervisorInstructions" placeholder="Supervisor Instructions" maxlength="50" />
              <div class="error" *ngIf="row.get('supervisorInstructions')?.invalid && row.get('supervisorInstructions')?.touched">
                Alphabets only (max 50).
              </div>
            </td>

            <td>
              <input type="text" class="form-control" formControlName="actionTaken" placeholder="Action Taken" maxlength="50" />
              <div class="error" *ngIf="row.get('actionTaken')?.invalid && row.get('actionTaken')?.touched">
                Alphabets only (max 50).
              </div>
            </td>

            <td>
              <input type="text" class="form-control" formControlName="startTime" placeholder="HH:MM AM/PM" />
              <div class="error" *ngIf="row.get('startTime')?.invalid && row.get('startTime')?.touched">
                Enter valid time (e.g., 09:30 AM).
              </div>
            </td>

            <td>
              <input type="text" class="form-control" formControlName="endTime" placeholder="HH:MM AM/PM" />
              <div class="error" *ngIf="row.get('endTime')?.invalid && row.get('endTime')?.touched">
                Enter valid time (e.g., 05:45 PM).
              </div>
            </td>

            <td>
              <button type="button" class="btn btn-outline-danger btn-sm" (click)="removeRow(i)" title="Delete"><i class="bi bi-trash"></i></button>
            </td>
          </tr>
        </tbody>
      </table>

      <div class="button-group mt-3">
        <button type="button" class="btn btn-add" (click)="addRow()">Add Row</button>
        <button type="submit" class="btn btn-submit">Submit</button>
      </div>
    </form>

    <!-- Custom Alert Box -->
    <div class="custom-alert" *ngIf="showAlert">
      <div class="alert-content">
        <p>{{ alertMessage }}</p>

        <div class="alert-buttons" *ngIf="confirmAction">
          <button class="btn btn-danger" (click)="confirmYes()">Yes</button>
          <button class="btn btn-secondary" (click)="closeAlert()">No</button>
        </div>

        <div class="alert-buttons" *ngIf="!confirmAction">
          <button class="btn btn-primary" (click)="closeAlert()">OK</button>
        </div>
      </div>
    </div>
  </div>
</section>
