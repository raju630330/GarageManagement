<div class="container mt-4">

  <!-- Add Module -->
  <div class="card mb-4">
    <div class="card-header bg-dark text-white">Add Module</div>
    <div class="card-body d-flex gap-2">
      <input class="form-control" placeholder="Module name" [(ngModel)]="newModuleName">
      <button class="btn btn-primary" (click)="addModule()">Add</button>
    </div>
  </div>

  <!-- Roles Permissions -->
  <div *ngFor="let role of roles" class="card mb-3">
    <div class="card-header bg-primary text-white">{{ role.roleName }}</div>
    <div class="card-body">
      <table class="table table-bordered">
        <thead>
          <tr>
            <th>Module</th>
            <th *ngFor="let p of permissionCodes">{{ p }}</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let m of modules">
            <td>{{ m.name }}</td>
            <td *ngFor="let p of permissionCodes" class="text-center">
              <input type="checkbox"
                     [checked]="isChecked(role.id, m.id, p)"
                     (change)="toggle(role.id, m.id, p)">
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <div class="text-end mt-3">
    <button class="btn btn-success" [disabled]="isSaving" (click)="save()">Save Permissions</button>
  </div>
</div>
