<div class="container mt-4">
  <h2 class="mb-3 text-primary fw-bold">
    <i class="bi bi-gear-fill me-2"></i> Spare Parts Issue Details
  </h2>

  <!-- Error Message -->
  <div *ngIf="errorMessage" class="alert alert-danger">
    {{ errorMessage }}
  </div>

  <form [formGroup]="partsForm" (ngSubmit)="onSubmit()">
    <div class="table-responsive">
      <table class="table table-bordered shadow-sm">
        <thead class="table-primary text-dark">
          <tr>
            <th><i class="bi bi-hash me-1"></i> Sl.No.</th>
            <th><i class="bi bi-card-text me-1"></i> Part Description</th>
            <th><i class="bi bi-upc-scan me-1"></i> Part Number</th>
            <th><i class="bi bi-building me-1"></i> Make</th>
            <th><i class="bi bi-cash-coin me-1"></i> Unit Cost (₹)</th>
            <th><i class="bi bi-123 me-1"></i> Qty</th>
            <th><i class="bi bi-wallet2 me-1"></i> Amount (₹)</th>
            <th><i class="bi bi-tools me-1"></i> Action</th>
          </tr>
        </thead>

        <tbody formArrayName="parts">
          <tr *ngFor="let part of parts.controls; let i = index" [formGroupName]="i">
            <!-- Auto Sl.No -->
            <td>{{ i + 1 }}</td>

            <td>
              <input type="text" class="form-control" formControlName="description" />
              <small class="text-danger" *ngIf="part.get('description')?.invalid && part.get('description')?.touched">
                Alphabets only
              </small>
            </td>

            <td>
              <input type="text" class="form-control" formControlName="partNumber" />
              <small class="text-danger" *ngIf="part.get('partNumber')?.invalid && part.get('partNumber')?.touched">
                Alphanumeric & - _ / # allowed
              </small>
            </td>

            <td>
              <input type="text" class="form-control" formControlName="make" />
              <small class="text-danger" *ngIf="part.get('make')?.invalid && part.get('make')?.touched">
                Alphabets only
              </small>
            </td>

            <td>
              <input type="text" class="form-control" formControlName="unitCost" />
              <small class="text-danger" *ngIf="part.get('unitCost')?.invalid && part.get('unitCost')?.touched">
                Valid number (max 2 decimals)
              </small>
            </td>

            <td>
              <input type="text" class="form-control" formControlName="qty" />
              <small class="text-danger" *ngIf="part.get('qty')?.invalid && part.get('qty')?.touched">
                Numbers only
              </small>
            </td>

            <td>{{ getAmount(i) | currency:'INR':'symbol' }}</td>

            <td>
              <button type="button" class="btn btn-outline-danger btn-sm" (click)="removePart(i)">
                <i class="bi bi-trash"></i>
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="d-flex justify-content-between align-items-center mt-2 flex-wrap">
      <button type="button" class="btn btn-outline-primary mb-2" (click)="addPart()">
        <i class="bi bi-plus-circle"></i> Add Row
      </button>
      <h5 class="fw-bold mb-2">Total: {{ getTotalAmount() | currency:'INR':'symbol' }}</h5>
    </div>

    <div class="mt-3">
      <button type="submit" class="btn btn-success">
        <i class="bi bi-check-circle"></i> Submit
      </button>
    </div>
  </form>
</div>
